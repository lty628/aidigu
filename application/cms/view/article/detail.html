
    {{include file='article/header' /}}

    <!-- 主内容 -->
    <main class="main-content">
        <div class="container">
            <!-- 文章详情 -->
            <section class="article-section">
                <div class="article-header">
                    <div class="author-info">
                        <div class="author-avatar">
                            <img src="{{$article.user.head_image}}" alt="作者头像" />
                        </div>
                        <div class="author-profile">
                            <div class="author-name">{{$article.user.nickname}}</div>
                            <a href="#" class="publish-time">发表于 {{$article.create_time | formatTime}}</a>
                        </div>
                        <a href="/article/category/{{$article.category.category_name}}/" class="category-link">
                            {{$article.category.category_name}}
                        </a>
                    </div>
                </div>
                <h1 class="article-title">{{$article.title}}</h1>
                <div class="article-content">
                    {{$article.content | raw}}
                </div>
                <div class="article-actions">
                    <div class="article-tags">
                        <!-- 标签占位 -->
                    </div>
                    <div class="action-buttons">
                        {{if $userInfo}}
                        <a href="javascript:;" id="commitMsg" class="action-button" style="display: none;">
                            <span class="action-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none">
                                    <path opacity="0.3" d="M20 3H4C2.89543 3 2 3.89543 2 5V16C2 17.1046 2.89543 18 4 18H4.5C5.05228 18 5.5 18.4477 5.5 19V21.5052C5.5 22.1441 6.21212 22.5253 6.74376 22.1708L11.4885 19.0077C12.4741 18.3506 13.6321 18 14.8167 18H20C21.1046 18 22 17.1046 22 16V5C22 3.89543 21.1046 3 20 3Z" fill="currentColor"></path>
                                    <rect x="6" y="12" width="7" height="2" rx="1" fill="currentColor"></rect>
                                    <rect x="6" y="7" width="12" height="2" rx="1" fill="currentColor"></rect>
                                </svg>
                            </span>
                            评论
                        </a>
                        {{/if}}
                        {{if $userInfo && $userInfo['uid'] == $article.user.uid}}
                        <a href="/article/edit/{{$article.content_id}}" class="action-button">
                            <span class="action-icon">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none">
                                    <path opacity="0.3" d="M16.163 17.55C17.0515 16.6633 17.6785 15.5488 17.975 14.329C18.2389 13.1884 18.8119 12.1425 19.631 11.306L12.694 4.36902C11.8574 5.18796 10.8115 5.76088 9.67099 6.02502C8.15617 6.3947 6.81277 7.27001 5.86261 8.50635C4.91245 9.74268 4.41238 11.266 4.44501 12.825C4.46196 13.6211 4.31769 14.4125 4.0209 15.1515C3.72412 15.8905 3.28092 16.5617 2.71799 17.125L2.28699 17.556C2.10306 17.7402 1.99976 17.9897 1.99976 18.25C1.99976 18.5103 2.10306 18.7598 2.28699 18.944L5.06201 21.719C5.24614 21.9029 5.49575 22.0062 5.75601 22.0062C6.01627 22.0062 6.26588 21.9029 6.45001 21.719L6.88101 21.288C7.44427 20.725 8.11556 20.2819 8.85452 19.9851C9.59349 19.6883 10.3848 19.5441 11.181 19.561C12.1042 19.58 13.0217 19.4114 13.878 19.0658C14.7343 18.7201 15.5116 18.2046 16.163 17.55Z" fill="currentColor" />
                                    <path d="M19.631 11.306L12.694 4.36902L14.775 2.28699C14.9591 2.10306 15.2087 1.99976 15.469 1.99976C15.7293 1.99976 15.9789 2.10306 16.163 2.28699L21.713 7.83704C21.8969 8.02117 22.0002 8.27075 22.0002 8.53101C22.0002 8.79126 21.8969 9.04085 21.713 9.22498L19.631 11.306ZM13.041 10.959C12.6427 10.5604 12.1194 10.3112 11.5589 10.2532C10.9985 10.1952 10.4352 10.332 9.96375 10.6405C9.4923 10.949 9.14148 11.4105 8.97034 11.9473C8.79919 12.4841 8.81813 13.0635 9.02399 13.588L2.98099 19.631L4.36899 21.019L10.412 14.975C10.9364 15.1816 11.5161 15.2011 12.0533 15.0303C12.5904 14.8594 13.0523 14.5086 13.361 14.037C13.6697 13.5654 13.8065 13.0018 13.7482 12.4412C13.6899 11.8805 13.4401 11.357 13.041 10.959Z" fill="currentColor" />
                                </svg>
                            </span>
                            编辑
                        </a>
                        {{/if}}
                    </div>
                </div>
            </section>

            <!-- 评论区 -->
            <section class="comments-section" style="display: none;">
                <h2 class="comments-title">评论区</h2>
                
                <!-- 评论表单 -->
                <div id="textCommit" class="comment-form" style="display: none;">
                    <div class="form-wrapper">
                        <div class="form-group">
                            <textarea name="" id="contentCommit" class="form-control" rows="4" placeholder="请输入您的评论..."></textarea>
                        </div>
                        <div class="form-actions">
                            <button onclick="contentCommit()" class="btn btn-primary" type="button">回复</button>
                        </div>
                    </div>
                </div>

                <!-- 评论列表 -->
                <div id="pinglun" class="comments-list">
                    <!-- 评论内容将通过AJAX加载 -->
                </div>

                <!-- 评论分页 -->
                <div class="pagination-wrapper">
                    <ul id="ajaxPage" class="pagination">
                    </ul>
                </div>
            </section>
        </div>
    </main>

    <!-- 页脚 -->
    {{include file='article/footer' /}}

    <input type="hidden" id="contentId" value="{{$article.content_id}}">

    <script>
        // 评论功能
        document.addEventListener('DOMContentLoaded', function() {
            // 显示评论表单
            const commentBtn = document.getElementById('commitMsg');
            const commentForm = document.getElementById('textCommit');
            
            if (commentBtn) {
                commentBtn.addEventListener('click', function() {
                    commentForm.style.display = commentForm.style.display === 'none' ? 'block' : 'none';
                });
            }

            // 加载评论列表（模拟）
            // loadComments();
        });

        function loadComments() {
            // 这里应该是AJAX请求获取评论列表
            // 为了演示，我们添加一些模拟评论
            const commentsList = document.getElementById('pinglun');
            const mockComments = [
                {
                    id: 1,
                    user: {
                        nickname: '用户1',
                        head_image: 'https://via.placeholder.com/40'
                    },
                    content: '这是一个很好的文章！',
                    create_time: '2023-10-01 10:00:00'
                },
                {
                    id: 2,
                    user: {
                        nickname: '用户2',
                        head_image: 'https://via.placeholder.com/40'
                    },
                    content: '学习了很多，谢谢分享！',
                    create_time: '2023-10-01 11:00:00'
                }
            ];

            let html = '';
            mockComments.forEach(comment => {
                html += `
                    <div class="comment-item">
                        <div class="comment-header">
                            <div class="comment-author">
                                <div class="comment-avatar">
                                    <img src="${comment.user.head_image}" alt="用户头像" />
                                </div>
                                <div>
                                    <div class="comment-name">${comment.user.nickname}</div>
                                    <div class="comment-time">${comment.create_time}</div>
                                </div>
                            </div>
                        </div>
                        <div class="comment-content">${comment.content}</div>
                    </div>
                `;
            });

            commentsList.innerHTML = html;
        }

        function contentCommit() {
            // 这里应该是AJAX请求提交评论
            const content = document.getElementById('contentCommit').value;
            const contentId = document.getElementById('contentId').value;
            
            if (!content.trim()) {
                alert('请输入评论内容');
                return;
            }

            // 模拟提交成功
            alert('评论提交成功！');
            document.getElementById('contentCommit').value = '';
            document.getElementById('textCommit').style.display = 'none';
            // loadComments(); // 重新加载评论列表
        }
    </script>
</body>
</html>